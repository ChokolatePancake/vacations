uuid: fc016784-7386-4ce5-811c-e8a723e26d66
langcode: en
status: true
dependencies:
  config:
    - field.field.node.certificate_flow.field_certificate
    - field.field.node.certificate_flow.field_days
    - field.field.node.certificate_flow.field_operation
    - field.field.node.certificate_flow.field_operation_with_days
    - field.field.node.vacations.field_date
    - field.field.node.vacations.field_date_and_time
    - field.field.node.vacations.field_full_days
    - field.field.user.user.field_available_days
    - field.storage.node.field_certificate
    - field.storage.node.field_date
    - field.storage.node.field_date_and_time
    - field.storage.node.field_days
    - field.storage.node.field_full_days
    - field.storage.node.field_operation
    - field.storage.node.field_operation_with_days
    - field.storage.user.field_available_days
    - node.type.certificate_flow
    - node.type.vacations
    - views.view.certificates_information
  module:
    - eca_base
    - eca_content
    - eca_form
    - eca_log
    - eca_tamper
    - eca_views
id: process_d524j1k
modeller: bpmn_io
label: noname
version: ''
weight: 0
events:
  Event_0vjqee8:
    plugin: 'content_entity:insert'
    label: Event_0vjqee8
    configuration:
      type: 'node vacations'
    successors:
      -
        id: Activity_1pqdgok
        condition: Flow_0t0a63k
  Event_0fgxt6j:
    plugin: 'content_entity:create'
    label: Event_0fgxt6j
    configuration:
      type: 'node vacations'
    successors:
      -
        id: Activity_0oyehfz
        condition: ''
  Event_136pzl1:
    plugin: 'form:form_validate'
    label: Event_136pzl1
    configuration:
      form_id: ''
      entity_type_id: ''
      bundle: vacations
      operation: ''
    successors:
      -
        id: Activity_1ip62kw
        condition: ''
conditions:
  Flow_0t0a63k:
    plugin: eca_entity_field_value
    configuration:
      negate: false
      case: false
      expected_value: '1'
      field_name: field_is_paid
      operator: equal
      type: value
      entity: ''
  Flow_13kh7pz:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[certificate-days]'
      right: '[full-days]'
      operator: atleast
      type: value
  Flow_10zgp9m:
    plugin: eca_scalar
    configuration:
      case: false
      left: '[item-list:field_days:value]'
      right: '0'
      operator: equal
      type: value
      negate: true
  Flow_1weflus:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[certificate-days]'
      right: '[full-days]'
      operator: lessthan
      type: value
  Flow_1fiirzb:
    plugin: eca_scalar
    configuration:
      case: false
      left: '[empty-certificate]'
      right: '[item-list:field_certificate:target_id]'
      operator: equal
      type: value
      negate: true
  Flow_0ybozwb:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[item-list:field_days:value]'
      right: '0'
      operator: equal
      type: value
  Flow_13bi7o1:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[empty-certificate]'
      right: '[item-list:field_certificate:target_id]'
      operator: equal
      type: value
  Flow_1vk1wk8:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[is-full-day]'
      right: '0'
      operator: equal
      type: value
  Flow_0gn4cyn:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[value]'
      right: '[current-date:raw]'
      operator: atleast
      type: value
  Flow_05ilvyl:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[is-full-day]'
      right: '1'
      operator: equal
      type: value
  Flow_1xys2u5:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[result]'
      right: '0'
      operator: lessthan
      type: value
  Flow_0r9fbs4:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[full_days]'
      right: '8'
      operator: lessthan
      type: value
  Flow_0ulx093:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '0, 6'
      right: '[start-day]'
      operator: contains
      type: value
  Flow_17bbmvy:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '0, 6'
      right: '[end-date]'
      operator: contains
      type: value
  Flow_065tefo:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '0,6'
      right: '[end]'
      operator: equal
      type: value
  Flow_05b7gel:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '0,6'
      right: '[start]'
      operator: contains
      type: value
  Flow_0a7j93i:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[available-days]'
      right: '[full_days]'
      operator: atleast
      type: value
  Flow_093mlke:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[available-days]'
      right: '[full_days]'
      operator: lessthan
      type: value
  Flow_06z3po8:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '1,2,3,4,5'
      right: '[end-date]'
      operator: contains
      type: value
  Flow_1ip05hy:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[result]'
      right: '86400'
      operator: lessthan
      type: value
  Flow_02i7rv5:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[is-paid]'
      right: '1'
      operator: equal
      type: value
  Flow_1n38jv4:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[is-paid]'
      right: '0'
      operator: equal
      type: value
  Flow_0tl9k1o:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[full_days]'
      right: '14'
      operator: greaterthan
      type: value
  Flow_0cd97t0:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[full_days]'
      right: '8'
      operator: lessthan
      type: value
  Flow_1kzm27b:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '0,6'
      right: '[end-day]'
      operator: contains
      type: value
  Flow_0p68wki:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '0,6'
      right: '[start-date]'
      operator: contains
      type: value
  Flow_0u3qx2u:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '1,2,3,4,5'
      right: '[start-date]'
      operator: contains
      type: value
  Flow_1pm27is:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[full_days]'
      right: '7'
      operator: greaterthan
      type: value
  Flow_1yij4ae:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[start-time]'
      right: '9'
      operator: lessthan
      type: value
  Flow_1wmchkk:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[end-time]'
      right: '18'
      operator: greaterthan
      type: value
  Flow_1ft2sqb:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[end-time]'
      right: '18'
      operator: equal
      type: value
  Flow_0e1244m:
    plugin: eca_scalar
    configuration:
      case: false
      left: '[end-minutes]'
      right: '0'
      operator: equal
      type: value
      negate: true
  Flow_1vba9uv:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[result]'
      right: '0'
      operator: equal
      type: value
  Flow_05soq6x:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[result]'
      right: '0'
      operator: lessthan
      type: value
  Flow_0blicmm:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[current-date:raw]'
      right: '[value-time]'
      operator: greaterthan
      type: value
gateways:
  Gateway_027c115:
    type: 0
    successors:
      -
        id: Activity_141ema0
        condition: ''
      -
        id: Activity_1x09ig6
        condition: ''
  Gateway_15mw1e4:
    type: 0
    successors:
      -
        id: Activity_1hjb1ew
        condition: Flow_0tl9k1o
      -
        id: Gateway_04pl7gi
        condition: ''
  Gateway_1vxt6p4:
    type: 0
    successors:
      -
        id: Gateway_1b691u1
        condition: Flow_0r9fbs4
      -
        id: Gateway_0jc0nno
        condition: ''
  Gateway_1b691u1:
    type: 0
    successors:
      -
        id: Activity_06ty3x6
        condition: ''
      -
        id: Activity_1venqzo
        condition: ''
  Gateway_0jc0nno:
    type: 0
    successors:
      -
        id: Activity_05ki6s5
        condition: ''
  Gateway_04pl7gi:
    type: 0
    successors:
      -
        id: Activity_1205289
        condition: ''
      -
        id: Gateway_0yoahe6
        condition: ''
  Gateway_0yoahe6:
    type: 0
    successors:
      -
        id: Gateway_0knupr5
        condition: Flow_0cd97t0
      -
        id: Gateway_17f2dkl
        condition: ''
  Gateway_0knupr5:
    type: 0
    successors:
      -
        id: Activity_1e0bln0
        condition: ''
      -
        id: Activity_0l060nh
        condition: ''
  Gateway_17f2dkl:
    type: 0
    successors:
      -
        id: Activity_04i0v17
        condition: Flow_1pm27is
  Gateway_1i45bsy:
    type: 0
    successors:
      -
        id: Activity_0gt4sye
        condition: Flow_1vba9uv
      -
        id: Activity_143ljic
        condition: Flow_05soq6x
  Gateway_1xv2t5b:
    type: 0
    successors:
      -
        id: Activity_1u7iiy9
        condition: ''
  Gateway_0ks304p:
    type: 0
    successors:
      -
        id: Activity_1vmlac8
        condition: ''
      -
        id: Gateway_1xv2t5b
        condition: ''
actions:
  Activity_0xf6sei:
    plugin: 'eca_tamper:math'
    label: Subtraction
    configuration:
      operation: subtraction
      flip: false
      value: '[value]'
      eca_data: '[end_value]'
      eca_token_name: full_days_unix
    successors:
      -
        id: Activity_0ephzfw
        condition: ''
  Activity_0mq0mys:
    plugin: eca_set_field_value
    label: 'Set days'
    configuration:
      field_name: field_full_days
      field_value: '[full_days]'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: true
      object: vacation
    successors: {  }
  Activity_0ephzfw:
    plugin: 'eca_tamper:math'
    label: 'UNIX to days'
    configuration:
      operation: division
      flip: false
      value: '86400'
      eca_data: '[full_days_unix]'
      eca_token_name: full_days_without_1
    successors:
      -
        id: Activity_1wh2kg4
        condition: ''
  Activity_1wh2kg4:
    plugin: 'eca_tamper:math'
    label: '+1 day'
    configuration:
      operation: addition
      flip: false
      value: '1'
      eca_data: '[full_days_without_1]'
      eca_token_name: full_days
    successors:
      -
        id: Gateway_15mw1e4
        condition: Flow_02i7rv5
      -
        id: Gateway_1vxt6p4
        condition: Flow_1n38jv4
  Activity_0vg9uzk:
    plugin: eca_token_load_entity_ref
    label: 'Load user'
    configuration:
      field_name_entity_ref: uid
      token_name: current-user
      from: current
      entity_type: user
      entity_id: ''
      revision_id: ''
      properties: ''
      langcode: _interface
      latest_revision: false
      unchanged: false
      object: vacation
    successors:
      -
        id: Activity_156bcft
        condition: ''
  Activity_156bcft:
    plugin: eca_views_query
    label: 'Execute query'
    configuration:
      token_name: certificates-list
      view_id: certificates_information
      display_id: default
      arguments: '[current-user:uid]'
    successors:
      -
        id: Activity_1w7g9ev
        condition: ''
  Activity_0210lgf:
    plugin: eca_get_field_value
    label: 'Get number of required days'
    configuration:
      field_name: field_full_days
      token_name: full-days
      object: vacation
    successors:
      -
        id: Activity_0vg9uzk
        condition: ''
  Activity_1at16hs:
    plugin: 'eca_tamper:math'
    label: 'Count balance days'
    configuration:
      operation: subtraction
      flip: false
      value: '[full-days]'
      eca_data: '[certificate-days]'
      eca_token_name: balance-days
    successors:
      -
        id: Activity_0oznekq
        condition: ''
  Activity_13k94cl:
    plugin: eca_token_set_value
    label: 'Load certificate available days'
    configuration:
      token_name: certificate-days
      token_value: '[item-list:field_days:value]'
      use_yaml: false
    successors:
      -
        id: Activity_1at16hs
        condition: Flow_13kh7pz
      -
        id: Activity_01cuhc5
        condition: Flow_1weflus
  Activity_0op8nbt:
    plugin: eca_set_field_value
    label: 'Set balance days'
    configuration:
      field_name: field_days
      field_value: '[balance-days]'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: false
      object: certificate-flow
    successors:
      -
        id: Activity_10e7qhi
        condition: ''
  Activity_1pjj4jr:
    plugin: eca_set_field_value
    label: 'Set operation with days'
    configuration:
      field_name: field_operation_with_days
      field_value: '[oper-days]'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: false
      object: certificate-flow
    successors:
      -
        id: Activity_1ne4p7y
        condition: ''
  Activity_10e7qhi:
    plugin: 'eca_tamper:math'
    label: 'Calculating operation with days'
    configuration:
      operation: multiplication
      flip: false
      value: '-1'
      eca_data: '[full-days]'
      eca_token_name: oper-days
    successors:
      -
        id: Activity_1pjj4jr
        condition: ''
  Activity_1ne4p7y:
    plugin: eca_set_field_value
    label: 'Set operation "Using"'
    configuration:
      field_name: field_operation.target_id
      field_value: '2'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: true
      object: certificate-flow
    successors: {  }
  Activity_0oznekq:
    plugin: eca_new_entity
    label: 'Create new certificate flow'
    configuration:
      token_name: certificate-flow
      type: 'node certificate_flow'
      langcode: ''
      label: Using
      published: true
      owner: '1'
    successors:
      -
        id: Activity_0apdul0
        condition: ''
  Activity_0apdul0:
    plugin: eca_set_field_value
    label: 'Set certificate id'
    configuration:
      field_name: field_certificate
      field_value: '[certificate]'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: false
      object: certificate-flow
    successors:
      -
        id: Activity_0op8nbt
        condition: ''
  Activity_1nbpk7u:
    plugin: eca_token_load_entity
    label: 'Load certificate'
    configuration:
      token_name: certificate
      from: id
      entity_type: node
      entity_id: '[item-list:field_certificate:target_id]'
      revision_id: ''
      properties: ''
      langcode: _interface
      latest_revision: false
      unchanged: false
      object: ''
    successors:
      -
        id: Activity_13k94cl
        condition: Flow_10zgp9m
      -
        id: Activity_11etmyq
        condition: Flow_0ybozwb
  Activity_1upv4hy:
    plugin: eca_new_entity
    label: 'Create new certificate flow'
    configuration:
      token_name: certificate-flow
      type: 'node certificate_flow'
      langcode: ''
      label: Using
      published: true
      owner: '1'
    successors:
      -
        id: Activity_0md9x5o
        condition: ''
  Activity_0md9x5o:
    plugin: eca_set_field_value
    label: 'Set certificate id'
    configuration:
      field_name: field_certificate
      field_value: '[certificate]'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: false
      object: certificate-flow
    successors:
      -
        id: Activity_051g6ky
        condition: ''
  Activity_01cuhc5:
    plugin: 'eca_tamper:math'
    label: 'Get remaining uncovered days'
    configuration:
      operation: subtraction
      flip: false
      value: '[certificate-days]'
      eca_data: '[full-days]'
      eca_token_name: full-days
    successors:
      -
        id: Activity_1upv4hy
        condition: ''
  Activity_051g6ky:
    plugin: 'eca_tamper:math'
    label: 'Calculating operation with days'
    configuration:
      operation: multiplication
      flip: false
      value: '-1'
      eca_data: '[certificate-days]'
      eca_token_name: oper-days
    successors:
      -
        id: Activity_1to36jl
        condition: ''
  Activity_1to36jl:
    plugin: eca_set_field_value
    label: 'Set field days to 0'
    configuration:
      field_name: field_days
      field_value: '0'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: false
      object: certificate-flow
    successors:
      -
        id: Activity_0fced9v
        condition: ''
  Activity_0fced9v:
    plugin: eca_set_field_value
    label: 'Set operation with days'
    configuration:
      field_name: field_operation_with_days
      field_value: '[oper-days]'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: false
      object: certificate-flow
    successors:
      -
        id: Activity_0kyi6q7
        condition: ''
  Activity_0kyi6q7:
    plugin: eca_set_field_value
    label: 'Set operation "Using"'
    configuration:
      field_name: field_operation.target_id
      field_value: '2'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: true
      object: certificate-flow
    successors:
      -
        id: Activity_1ib0z07
        condition: ''
  Activity_1w7g9ev:
    plugin: eca_list_remove
    label: 'Pop first certificate flow info'
    configuration:
      value: ''
      token_name: item-list
      method: index
      index: '0'
      list_token: certificates-list
    successors:
      -
        id: Activity_1nbpk7u
        condition: Flow_1fiirzb
      -
        id: Activity_1w7g9ev
        condition: Flow_13bi7o1
  Activity_11etmyq:
    plugin: eca_token_set_value
    label: 'If certificate empty save id in token and avoid it'
    configuration:
      token_name: empty-certificate
      token_value: '[item-list:field_certificate:target_id]'
      use_yaml: false
    successors:
      -
        id: Activity_1w7g9ev
        condition: ''
  Activity_1ib0z07:
    plugin: eca_token_set_value
    label: 'Create token with empty certificate id to avoid it in next circle'
    configuration:
      token_name: empty-certificate
      token_value: '[item-list:field_certificate:target_id]'
      use_yaml: false
    successors:
      -
        id: Activity_1w7g9ev
        condition: ''
  Activity_0oyehfz:
    plugin: eca_token_load_entity_ref
    label: 'Load author'
    configuration:
      field_name_entity_ref: uid
      token_name: Author
      from: current
      entity_type: _none
      entity_id: ''
      revision_id: ''
      properties: ''
      langcode: _interface
      latest_revision: false
      unchanged: false
      object: ''
    successors:
      -
        id: Activity_0gg4cj4
        condition: ''
  Activity_0gg4cj4:
    plugin: eca_set_field_value
    label: 'Set title "Author''s vacation reques"'
    configuration:
      field_name: title
      field_value: "[author:name]'s vacation reques"
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: false
      object: ''
    successors: {  }
  Activity_1vi0tr7:
    plugin: eca_form_field_get_value
    label: 'Get end date'
    configuration:
      token_name: end-date
      field_name: 'field_date[0][end_value][date]'
      strip_tags: true
      trim: true
      xss_filter: true
    successors:
      -
        id: Activity_1abhdau
        condition: ''
  Activity_1abhdau:
    plugin: 'eca_tamper:strtotime'
    label: 'Start date to UNIX'
    configuration:
      eca_data: '[start]'
      eca_token_name: value
    successors:
      -
        id: Activity_1ow7ol1
        condition: ''
  Activity_1ow7ol1:
    plugin: 'eca_tamper:strtotime'
    label: 'End date to UNIX'
    configuration:
      eca_data: '[end-date]'
      eca_token_name: end_value
    successors:
      -
        id: Activity_0xf6sei
        condition: ''
  Activity_0nj7bqi:
    plugin: eca_form_field_get_value
    label: 'Get start date'
    configuration:
      token_name: start
      field_name: 'field_date[0][value][date]'
      strip_tags: true
      trim: true
      xss_filter: true
    successors:
      -
        id: Activity_1vi0tr7
        condition: ''
  Activity_1hjb1ew:
    plugin: eca_form_field_set_error
    label: 'Show error in date'
    configuration:
      message: "You can't take more than 14 days off"
      field_name: field_date
    successors: {  }
  Activity_0z7ysg3:
    plugin: eca_form_field_get_value
    label: 'Get start date time(date)'
    configuration:
      token_name: start
      field_name: 'field_date_and_time[0][value][date]'
      strip_tags: true
      trim: true
      xss_filter: true
    successors:
      -
        id: Activity_1bgzjgk
        condition: ''
  Activity_09ngmg3:
    plugin: eca_form_field_get_value
    label: 'Get end date time(date)'
    configuration:
      token_name: end
      field_name: 'field_date_and_time[0][end_value][date]'
      strip_tags: true
      trim: true
      xss_filter: true
    successors:
      -
        id: Activity_0or8fza
        condition: ''
  Activity_14it3nw:
    plugin: 'eca_tamper:strtotime'
    label: 'Start date time to UNIX'
    configuration:
      eca_data: '[start]'
      eca_token_name: value
    successors:
      -
        id: Activity_0uq60ov
        condition: Flow_0gn4cyn
  Activity_0uq60ov:
    plugin: 'eca_tamper:strtotime'
    label: 'End date time to UNIX'
    configuration:
      eca_data: '[end]'
      eca_token_name: end_value
    successors:
      -
        id: Activity_0pjqqiq
        condition: ''
  Activity_1ip62kw:
    plugin: eca_form_field_get_value
    label: 'Is checked is_full_day'
    configuration:
      token_name: is-full-day
      field_name: 'field_is_full_day[value]'
      strip_tags: true
      trim: true
      xss_filter: true
    successors:
      -
        id: Activity_0z7ysg3
        condition: Flow_1vk1wk8
      -
        id: Activity_0ecrdsh
        condition: Flow_05ilvyl
  Activity_0pjqqiq:
    plugin: 'eca_tamper:math'
    label: Subtraction
    configuration:
      operation: subtraction
      flip: false
      value: '[value]'
      eca_data: '[end_value]'
      eca_token_name: full_days_unix
    successors:
      -
        id: Gateway_027c115
        condition: ''
  Activity_068aabg:
    plugin: eca_form_field_set_error
    label: 'Show error about past date input'
    configuration:
      message: 'Past times are not allowed'
      field_name: field_date_and_time
    successors: {  }
  Activity_0oh1zz6:
    plugin: eca_form_field_set_error
    label: 'Show error about past date input'
    configuration:
      message: 'Past times are not allowed'
      field_name: field_date
    successors: {  }
  Activity_06ty3x6:
    plugin: 'eca_tamper:timetodate'
    label: 'UNIX start date to day of week as number'
    configuration:
      date_format: w
      eca_data: '[value]'
      eca_token_name: start-day
    successors:
      -
        id: Activity_0yoggn0
        condition: Flow_0ulx093
  Activity_0yoggn0:
    plugin: eca_form_field_set_error
    label: 'Show error about weekend start day'
    configuration:
      message: 'You choosed a weekend as the start day for shorter than 7 days'
      field_name: field_date
    successors: {  }
  Activity_1venqzo:
    plugin: 'eca_tamper:timetodate'
    label: 'UNIX end date to day of week as number'
    configuration:
      date_format: w
      eca_data: '[end_value]'
      eca_token_name: end-date
    successors:
      -
        id: Activity_17adey6
        condition: Flow_17bbmvy
  Activity_17adey6:
    plugin: eca_form_field_set_error
    label: 'Show error about weekend start day'
    configuration:
      message: 'You choosed a weekend as the end day for shorter than 7 days'
      field_name: field_date
    successors: {  }
  Activity_141ema0:
    plugin: 'eca_tamper:timetodate'
    label: 'UNIX start date to day of week as number'
    configuration:
      date_format: w
      eca_data: '[value]'
      eca_token_name: start
    successors:
      -
        id: Activity_1wxy8b2
        condition: Flow_05b7gel
  Activity_1x09ig6:
    plugin: 'eca_tamper:timetodate'
    label: 'UNIX end date to day of week as number'
    configuration:
      date_format: w
      eca_data: '[end_value]'
      eca_token_name: end
    successors:
      -
        id: Activity_0ffiv3f
        condition: Flow_065tefo
  Activity_1wxy8b2:
    plugin: eca_form_field_set_error
    label: 'Show error about weekend start day'
    configuration:
      message: 'You choosed a weekend as the start day for shorter than 7 days'
      field_name: field_date_and_time
    successors: {  }
  Activity_0ffiv3f:
    plugin: eca_form_field_set_error
    label: 'Show error about weekend start day'
    configuration:
      message: 'You choosed a weekend as the start day for shorter than 7 days'
      field_name: field_date_and_time
    successors: {  }
  Activity_04i0v17:
    plugin: eca_token_load_entity_ref
    label: 'Load author'
    configuration:
      field_name_entity_ref: uid
      token_name: author
      from: current
      entity_type: _none
      entity_id: ''
      revision_id: ''
      properties: ''
      langcode: _interface
      latest_revision: false
      unchanged: false
      object: ''
    successors:
      -
        id: Activity_16n31o8
        condition: ''
  Activity_16n31o8:
    plugin: eca_get_field_value
    label: 'Load available days'
    configuration:
      field_name: field_available_days
      token_name: available-days
      object: author
    successors:
      -
        id: Activity_0mq0mys
        condition: Flow_0a7j93i
      -
        id: Activity_08s8ucx
        condition: Flow_093mlke
  Activity_08s8ucx:
    plugin: eca_form_field_set_error
    label: 'Show error not enough available days'
    configuration:
      message: "You don't have anough available days for paid vacation. You have: [available-days], you need: [full_days]"
      field_name: field_date
    successors: {  }
  Activity_1pqdgok:
    plugin: eca_token_load_entity
    label: 'Load vacation'
    configuration:
      token_name: vacation
      from: current
      entity_type: _none
      entity_id: ''
      revision_id: ''
      properties: ''
      langcode: _interface
      latest_revision: false
      unchanged: false
      object: ''
    successors:
      -
        id: Activity_0210lgf
        condition: ''
  Activity_0ecrdsh:
    plugin: eca_form_field_get_value
    label: 'Is paid'
    configuration:
      token_name: is-paid
      field_name: 'field_is_paid[value]'
      strip_tags: true
      trim: true
      xss_filter: true
    successors:
      -
        id: Activity_0nj7bqi
        condition: ''
  Activity_0wqdocf:
    plugin: 'eca_tamper:timetodate'
    label: 'UNIX end date to day of week as number'
    configuration:
      date_format: w
      eca_data: '[end_value]'
      eca_token_name: end-date
    successors:
      -
        id: Activity_04i0v17
        condition: Flow_06z3po8
  Activity_05ki6s5:
    plugin: eca_token_set_value
    label: 'Token current day'
    configuration:
      token_name: current-day
      token_value: '[current-date:date_all_day]'
      use_yaml: false
    successors:
      -
        id: Activity_07jnsz3
        condition: ''
  Activity_07jnsz3:
    plugin: 'eca_tamper:strtotime'
    label: 'Current day to UNIX'
    configuration:
      eca_data: '[current-day]'
      eca_token_name: current-day-unix
    successors:
      -
        id: Activity_0ha6m6d
        condition: ''
  Activity_0ha6m6d:
    plugin: 'eca_tamper:math'
    label: 'Subtract start date from current'
    configuration:
      operation: subtraction
      flip: false
      value: '[current-day-unix]'
      eca_data: '[value]'
      eca_token_name: result
    successors:
      -
        id: Activity_0oh1zz6
        condition: Flow_1xys2u5
  Activity_0gt4sye:
    plugin: eca_form_field_set_error
    label: "Show error paid vacation can't start today"
    configuration:
      message: "Paid vacation can't start today, change date or request unpaid vacation"
      field_name: field_date
    successors: {  }
  Activity_1205289:
    plugin: eca_token_set_value
    label: 'Token current day'
    configuration:
      token_name: current-day
      token_value: '[current-date:date_all_day]'
      use_yaml: false
    successors:
      -
        id: Activity_15e9d2i
        condition: ''
  Activity_15e9d2i:
    plugin: 'eca_tamper:strtotime'
    label: 'Current day to UNIX'
    configuration:
      eca_data: '[current-day]'
      eca_token_name: current-day-unix
    successors:
      -
        id: Activity_1qa5du5
        condition: ''
  Activity_1qa5du5:
    plugin: 'eca_tamper:math'
    label: 'Subtract start date from current'
    configuration:
      operation: subtraction
      flip: false
      value: '[current-day-unix]'
      eca_data: '[value]'
      eca_token_name: result
    successors:
      -
        id: Gateway_1i45bsy
        condition: Flow_1ip05hy
  Activity_1e0bln0:
    plugin: 'eca_tamper:timetodate'
    label: 'UNIX start date to day of week as number'
    configuration:
      date_format: w
      eca_data: '[value]'
      eca_token_name: start-date
    successors:
      -
        id: Activity_1xg1csj
        condition: Flow_0p68wki
      -
        id: Activity_0wqdocf
        condition: Flow_0u3qx2u
  Activity_0l060nh:
    plugin: 'eca_tamper:timetodate'
    label: 'UNIX end date to day of week as number'
    configuration:
      date_format: w
      eca_data: '[end_value]'
      eca_token_name: end-date
    successors:
      -
        id: Activity_13tsq27
        condition: Flow_1kzm27b
  Activity_13tsq27:
    plugin: eca_form_field_set_error
    label: 'Show error about weekend start day'
    configuration:
      message: 'You choosed a weekend as the end day for shorter than 7 days'
      field_name: field_date
    successors: {  }
  Activity_1xg1csj:
    plugin: eca_form_field_set_error
    label: 'Show error about weekend start day'
    configuration:
      message: 'You choosed a weekend as the start day for shorter than 7 days'
      field_name: field_date
    successors: {  }
  Activity_1vmlac8:
    plugin: 'eca_tamper:timetodate'
    label: 'UNIX start date to hours'
    configuration:
      date_format: H
      eca_data: '[value-time]'
      eca_token_name: start-time
    successors:
      -
        id: Activity_17woknc
        condition: Flow_1yij4ae
  Activity_12kqf6o:
    plugin: eca_form_field_set_error
    label: 'Show error non-working end time'
    configuration:
      message: 'The selected end time is not within working schedule'
      field_name: field_date_and_time
    successors: {  }
  Activity_1u7iiy9:
    plugin: 'eca_tamper:timetodate'
    label: 'UNIX end date to hours'
    configuration:
      date_format: H
      eca_data: '[end_value-time]'
      eca_token_name: end-time
    successors:
      -
        id: Activity_12kqf6o
        condition: Flow_1wmchkk
      -
        id: Activity_0y3jpta
        condition: Flow_1ft2sqb
  Activity_0y3jpta:
    plugin: 'eca_tamper:timetodate'
    label: 'UNIX end date to minutes'
    configuration:
      date_format: I
      eca_data: '[end_value-time]'
      eca_token_name: end-minutes
    successors:
      -
        id: Activity_12kqf6o
        condition: Flow_0e1244m
  Activity_143ljic:
    plugin: eca_form_field_set_error
    label: 'Show error about past date input'
    configuration:
      message: 'Past times are not allowed'
      field_name: field_date
    successors: {  }
  Activity_1bgzjgk:
    plugin: eca_form_field_get_value
    label: 'Get start date time(time)'
    configuration:
      token_name: start-date-time
      field_name: 'field_date_and_time[0][value][time]'
      strip_tags: true
      trim: true
      xss_filter: true
    successors:
      -
        id: Activity_09ngmg3
        condition: ''
  Activity_07yidjb:
    plugin: eca_form_field_get_value
    label: 'Get end date time(time)'
    configuration:
      token_name: end-date-time
      field_name: 'field_date_and_time[0][end_value][time]'
      strip_tags: true
      trim: true
      xss_filter: true
    successors: {  }
  Activity_0or8fza:
    plugin: 'eca_tamper:strtotime'
    label: 'Start time to UNIX'
    configuration:
      eca_data: '[start-date-time]'
      eca_token_name: value-time
    successors:
      -
        id: Activity_068aabg
        condition: Flow_0blicmm
      -
        id: Activity_14it3nw
        condition: ''
      -
        id: Activity_125dj7n
        condition: ''
  Activity_0auzvi9:
    plugin: 'eca_tamper:strtotime'
    label: 'End time to UNIX'
    configuration:
      eca_data: '[end-date-time]'
      eca_token_name: end_value-time
    successors: {  }
  Activity_17woknc:
    plugin: eca_form_field_set_error
    label: 'Show error non-working start time'
    configuration:
      message: 'The selected start time is not within working schedule'
      field_name: field_date_and_time
    successors: {  }
  Activity_125dj7n:
    plugin: eca_write_log_message
    label: Activity_125dj7n
    configuration:
      channel: a
      severity: '1'
      message: |-
        current:[current-date:raw]
        time:[value-time]
    successors: {  }
  Activity_12yugtg:
    plugin: 'eca_tamper:math'
    label: Activity_12yugtg
    configuration:
      operation: addition
      flip: false
      value: '[value-time]'
      eca_data: '[value]'
      eca_token_name: full-start
    successors:
      -
        id: Activity_125dj7n
        condition: ''
