uuid: 494e0dfe-e792-44e6-8d40-4ff15fa42ad8
langcode: en
status: true
dependencies:
  config:
    - field.field.node.certificate.field_user
    - field.field.node.certificate_flow.field_balance
    - field.field.node.certificate_flow.field_certificate
    - field.field.node.certificate_flow.field_days
    - field.field.node.certificate_flow.field_operation
    - field.field.node.certificate_flow.field_operation_with_days
    - field.field.node.certificate_flow.field_vacation
    - field.field.node.vacations.field_approvers
    - field.field.node.vacations.field_date
    - field.field.node.vacations.field_date_and_time
    - field.field.node.vacations.field_full_days
    - field.field.node.vacations.field_status
    - field.storage.node.field_approvers
    - field.storage.node.field_balance
    - field.storage.node.field_certificate
    - field.storage.node.field_date
    - field.storage.node.field_date_and_time
    - field.storage.node.field_days
    - field.storage.node.field_full_days
    - field.storage.node.field_operation
    - field.storage.node.field_operation_with_days
    - field.storage.node.field_status
    - field.storage.node.field_user
    - field.storage.node.field_vacation
    - flag.flag.cancel
    - node.type.certificate_flow
    - node.type.vacations
    - views.view.certificates_information
    - views.view.long_vacation
    - views.view.paid_vacations
    - views.view.records
    - views.view.records_by_certificate
    - views.view.vacation_s_certificates
  module:
    - eca_base
    - eca_content
    - eca_form
    - eca_tamper
    - eca_views
id: process_affvezc
modeller: bpmn_io
label: 'Vacations (clone)'
version: ''
weight: 0
events:
  Event_0fgxt6j:
    plugin: 'content_entity:create'
    label: Event_0fgxt6j
    configuration:
      type: 'node vacations'
    successors:
      -
        id: Activity_0oyehfz
        condition: ''
  Event_136pzl1:
    plugin: 'form:form_validate'
    label: Event_136pzl1
    configuration:
      form_id: ''
      entity_type_id: ''
      bundle: vacations
      operation: ''
    successors:
      -
        id: Activity_1cz4133
        condition: ''
  Event_0vjqee8:
    plugin: 'content_entity:update'
    label: Event_0vjqee8
    configuration:
      type: 'node vacations'
    successors:
      -
        id: Activity_1pqdgok
        condition: ''
  Event_1leum74:
    plugin: 'content_entity:presave'
    label: Event_1leum74
    configuration:
      type: 'node vacations'
    successors:
      -
        id: Activity_1ajgw72
        condition: Flow_0po1zom
  Event_1ltfq03:
    plugin: 'content_entity:insert'
    label: Event_1ltfq03
    configuration:
      type: 'flagging cancel'
    successors:
      -
        id: Activity_1s8anfc
        condition: ''
conditions:
  Flow_1vy7gm2:
    plugin: eca_entity_field_value
    configuration:
      negate: false
      case: false
      expected_value: '7'
      field_name: field_status
      operator: equal
      type: value
      entity: vacation
  Flow_0t0a63k:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[node:field_is_paid:value]'
      right: '1'
      operator: equal
      type: value
  Flow_13kh7pz:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[certificate-days]'
      right: '[full-days]'
      operator: atleast
      type: value
  Flow_16d6wjp:
    plugin: eca_scalar
    configuration:
      case: false
      left: '[balance-days]'
      right: '0'
      operator: equal
      type: value
      negate: true
  Flow_10zgp9m:
    plugin: eca_scalar
    configuration:
      case: false
      left: '[item-list:field_days:value]'
      right: '0'
      operator: equal
      type: value
      negate: true
  Flow_1weflus:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[certificate-days]'
      right: '[full-days]'
      operator: lessthan
      type: value
  Flow_1fiirzb:
    plugin: eca_scalar
    configuration:
      case: false
      left: '[empty-certificate]'
      right: '[item-list:field_certificate:target_id]'
      operator: equal
      type: value
      negate: true
  Flow_0ybozwb:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[item-list:field_days:value]'
      right: '0'
      operator: equal
      type: value
  Flow_13bi7o1:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[empty-certificate]'
      right: '[item-list:field_certificate:target_id]'
      operator: equal
      type: value
  Flow_0gn4cyn:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[value]'
      right: '[current-date:raw]'
      operator: atleast
      type: value
  Flow_1xys2u5:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[result]'
      right: '0'
      operator: lessthan
      type: value
  Flow_0r9fbs4:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[full_days]'
      right: '8'
      operator: lessthan
      type: value
  Flow_0ulx093:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '0, 6'
      right: '[start-day]'
      operator: contains
      type: value
  Flow_17bbmvy:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '0, 6'
      right: '[end-date]'
      operator: contains
      type: value
  Flow_065tefo:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '0,6'
      right: '[end]'
      operator: equal
      type: value
  Flow_05b7gel:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '0,6'
      right: '[start]'
      operator: contains
      type: value
  Flow_093mlke:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[available-days]'
      right: '[full_days]'
      operator: lessthan
      type: value
  Flow_06z3po8:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '1,2,3,4,5'
      right: '[end-date]'
      operator: contains
      type: value
  Flow_1ip05hy:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[result]'
      right: '86400'
      operator: lessthan
      type: value
  Flow_02i7rv5:
    plugin: eca_entity_field_value
    configuration:
      negate: false
      case: false
      expected_value: '1'
      field_name: field_is_paid
      operator: equal
      type: value
      entity: vacation
  Flow_1n38jv4:
    plugin: eca_entity_field_value
    configuration:
      negate: false
      case: false
      expected_value: '0'
      field_name: field_is_paid
      operator: equal
      type: value
      entity: vacation
  Flow_0tl9k1o:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[full_days]'
      right: '14'
      operator: greaterthan
      type: value
  Flow_0cd97t0:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[full_days]'
      right: '8'
      operator: lessthan
      type: value
  Flow_1kzm27b:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '0,6'
      right: '[end-day]'
      operator: contains
      type: value
  Flow_0p68wki:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '0,6'
      right: '[start-date]'
      operator: contains
      type: value
  Flow_0u3qx2u:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '1,2,3,4,5'
      right: '[start-date]'
      operator: contains
      type: value
  Flow_1pm27is:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[full_days]'
      right: '7'
      operator: greaterthan
      type: value
  Flow_1yij4ae:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[start-time]'
      right: '9'
      operator: lessthan
      type: value
  Flow_1wmchkk:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[end-time]'
      right: '18'
      operator: greaterthan
      type: value
  Flow_1ft2sqb:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[end-time]'
      right: '18'
      operator: equal
      type: value
  Flow_0e1244m:
    plugin: eca_scalar
    configuration:
      case: false
      left: '[end-minutes]'
      right: '0'
      operator: equal
      type: value
      negate: true
  Flow_1vba9uv:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[result]'
      right: '0'
      operator: equal
      type: value
  Flow_05soq6x:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[result]'
      right: '0'
      operator: lessthan
      type: value
  Flow_19jcp7c:
    plugin: eca_entity_field_value
    configuration:
      negate: false
      case: false
      expected_value: '0'
      field_name: field_is_full_day
      operator: equal
      type: value
      entity: vacation
  Flow_01v7pmu:
    plugin: eca_entity_field_value
    configuration:
      negate: false
      case: false
      expected_value: '1'
      field_name: field_is_full_day
      operator: equal
      type: value
      entity: vacation
  Flow_0po1zom:
    plugin: eca_entity_field_value
    configuration:
      negate: false
      case: false
      expected_value: '1'
      field_name: field_is_paid
      operator: equal
      type: value
      entity: ''
  Flow_1o3t2ck:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[full_days]'
      right: '7'
      operator: lessthan
      type: value
  Flow_1xth8tc:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[future-balance]'
      right: '7'
      operator: lessthan
      type: value
  Flow_1ls6oaj:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[seniority]'
      right: '1440'
      operator: lessthan
      type: value
  Flow_1m0kokw:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[seniority]'
      right: '1440'
      operator: greaterthan
      type: value
  Flow_0k5oqxr:
    plugin: eca_token_exists
    configuration:
      token_name: relax
      negate: true
  Flow_1e4zneg:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[seniority]'
      right: '1080'
      operator: greaterthan
      type: value
  Flow_0l1fko4:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[seniority-months]'
      right: '6'
      operator: atleast
      type: value
  Flow_1uybf16:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[vacation:field_is_paid:value]'
      right: '1'
      operator: equal
      type: value
  Flow_09doap1:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[current-date:raw]'
      right: '[value]'
      operator: greaterthan
      type: value
  Flow_18epwfg:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[vacation:field_status:target_id]'
      right: '7'
      operator: equal
      type: value
  Flow_0vtx2bx:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[vacation:field_status:target_id]'
      right: '6'
      operator: equal
      type: value
  Flow_0s9jvoi:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[balance-days]'
      right: '0'
      operator: equal
      type: value
  Flow_0d6m569:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[vacation:field_approvers]'
      right: '[author-name]'
      operator: contains
      type: value
  Flow_09h8t4r:
    plugin: eca_scalar
    configuration:
      case: false
      left: '[balance-days]'
      right: '0'
      operator: equal
      type: value
      negate: true
  Flow_0buqus7:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[start-difference-day]'
      right: '-15'
      operator: greaterthan
      type: value
  Flow_1b93p2h:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[start-difference-day]'
      right: '15'
      operator: lessthan
      type: value
  Flow_03uh7pd:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[start-difference-day]'
      right: '14'
      operator: greaterthan
      type: value
  Flow_1nafdld:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[start-day2]'
      right: '[value]'
      operator: lessthan
      type: value
  Flow_1bnvccu:
    plugin: eca_scalar
    configuration:
      case: false
      left: '[start-difference-day]'
      right: '0'
      operator: equal
      type: value
      negate: true
  Flow_1jbwjo2:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[start-difference-day]'
      right: '0'
      operator: equal
      type: value
  Flow_0ld98an:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[value]'
      right: '[end-day2]'
      operator: atmost
      type: value
  Flow_158vi38:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[start-day2]'
      right: '[value]'
      operator: greaterthan
      type: value
  Flow_0ye7fvl:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[end_value]'
      right: '[start-day2]'
      operator: atleast
      type: value
  Flow_0dyoojw:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[value]'
      right: '[end-day2]'
      operator: greaterthan
      type: value
  Flow_1ifpfvu:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[end_value]'
      right: '[start-day2]'
      operator: lessthan
      type: value
  Flow_0k39bz5:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[start-difference-day]'
      right: '-14'
      operator: lessthan
      type: value
gateways:
  Gateway_027c115:
    type: 0
    successors:
      -
        id: Activity_141ema0
        condition: ''
      -
        id: Activity_1x09ig6
        condition: ''
  Gateway_15mw1e4:
    type: 0
    successors:
      -
        id: Activity_1hjb1ew
        condition: Flow_0tl9k1o
      -
        id: Gateway_04pl7gi
        condition: ''
  Gateway_1vxt6p4:
    type: 0
    successors:
      -
        id: Gateway_1b691u1
        condition: Flow_0r9fbs4
      -
        id: Gateway_0jc0nno
        condition: ''
  Gateway_1b691u1:
    type: 0
    successors:
      -
        id: Activity_06ty3x6
        condition: ''
      -
        id: Activity_1venqzo
        condition: ''
  Gateway_0jc0nno:
    type: 0
    successors:
      -
        id: Activity_05ki6s5
        condition: ''
  Gateway_04pl7gi:
    type: 0
    successors:
      -
        id: Activity_1205289
        condition: ''
      -
        id: Gateway_0yoahe6
        condition: ''
  Gateway_0yoahe6:
    type: 0
    successors:
      -
        id: Gateway_0knupr5
        condition: Flow_0cd97t0
      -
        id: Gateway_17f2dkl
        condition: ''
  Gateway_0knupr5:
    type: 0
    successors:
      -
        id: Activity_1e0bln0
        condition: ''
      -
        id: Activity_0l060nh
        condition: ''
  Gateway_17f2dkl:
    type: 0
    successors:
      -
        id: Activity_04i0v17
        condition: Flow_1pm27is
  Gateway_1i45bsy:
    type: 0
    successors:
      -
        id: Activity_0gt4sye
        condition: Flow_1vba9uv
      -
        id: Activity_143ljic
        condition: Flow_05soq6x
  Gateway_1xv2t5b:
    type: 0
    successors:
      -
        id: Activity_1u7iiy9
        condition: ''
  Gateway_0ks304p:
    type: 0
    successors:
      -
        id: Activity_1vmlac8
        condition: ''
      -
        id: Gateway_1xv2t5b
        condition: ''
  Gateway_19ezeba:
    type: 0
    successors:
      -
        id: Gateway_0r4en82
        condition: Flow_1ls6oaj
      -
        id: Activity_0n9zlw6
        condition: Flow_1m0kokw
  Gateway_0r4en82:
    type: 0
    successors:
      -
        id: Activity_17ck8vl
        condition: Flow_1e4zneg
  Gateway_1p5tbym:
    type: 0
    successors:
      -
        id: Gateway_0cg0tjt
        condition: Flow_1b93p2h
  Gateway_0cg0tjt:
    type: 0
    successors:
      -
        id: Gateway_0gi97mr
        condition: Flow_1nafdld
      -
        id: Gateway_1apq8cv
        condition: Flow_158vi38
  Gateway_12mm88y:
    type: 0
    successors:
      -
        id: Gateway_1p5tbym
        condition: Flow_0buqus7
  Gateway_0gi97mr:
    type: 0
    successors:
      -
        id: Activity_11w4pi5
        condition: Flow_0ld98an
      -
        id: Gateway_1ropv28
        condition: Flow_0dyoojw
  Gateway_1apq8cv:
    type: 0
    successors:
      -
        id: Activity_11w4pi5
        condition: Flow_0ye7fvl
      -
        id: Gateway_1ropv28
        condition: Flow_1ifpfvu
  Gateway_1ropv28:
    type: 0
    successors:
      -
        id: Activity_1lthfxj
        condition: ''
  Gateway_1nby4so:
    type: 0
    successors: {  }
actions:
  Activity_0xf6sei:
    plugin: 'eca_tamper:math'
    label: Subtraction
    configuration:
      operation: subtraction
      flip: false
      value: '[value]'
      eca_data: '[end_value]'
      eca_token_name: full_days_unix
    successors:
      -
        id: Activity_0ephzfw
        condition: ''
  Activity_0mq0mys:
    plugin: eca_set_field_value
    label: 'Set days'
    configuration:
      field_name: field_full_days
      field_value: '[full_days]'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: false
      object: ''
    successors: {  }
  Activity_0ephzfw:
    plugin: 'eca_tamper:math'
    label: 'UNIX to days'
    configuration:
      operation: division
      flip: false
      value: '86400'
      eca_data: '[full_days_unix]'
      eca_token_name: full_days_without_1
    successors:
      -
        id: Activity_0ew26i2
        condition: ''
  Activity_1wh2kg4:
    plugin: 'eca_tamper:math'
    label: '+1 day'
    configuration:
      operation: addition
      flip: false
      value: '1'
      eca_data: '[full_days_without_1]'
      eca_token_name: full_days
    successors:
      -
        id: Activity_0mq0mys
        condition: ''
  Activity_0vg9uzk:
    plugin: eca_token_load_entity_ref
    label: 'Load user'
    configuration:
      field_name_entity_ref: uid
      token_name: current-user
      from: current
      entity_type: user
      entity_id: ''
      revision_id: ''
      properties: ''
      langcode: _interface
      latest_revision: false
      unchanged: false
      object: ''
    successors:
      -
        id: Activity_156bcft
        condition: Flow_1vy7gm2
  Activity_156bcft:
    plugin: eca_views_query
    label: 'Execute query'
    configuration:
      token_name: certificates-list
      view_id: certificates_information
      display_id: default
      arguments: '[current-user:uid]'
    successors:
      -
        id: Activity_1w7g9ev
        condition: ''
  Activity_0210lgf:
    plugin: eca_get_field_value
    label: 'Get number of required days'
    configuration:
      field_name: field_full_days
      token_name: full-days
      object: ''
    successors:
      -
        id: Activity_0vg9uzk
        condition: Flow_0t0a63k
  Activity_1at16hs:
    plugin: 'eca_tamper:math'
    label: 'Count balance days'
    configuration:
      operation: subtraction
      flip: false
      value: '[full-days]'
      eca_data: '[certificate-days]'
      eca_token_name: balance-days
    successors:
      -
        id: Activity_0oznekq
        condition: ''
  Activity_13k94cl:
    plugin: eca_token_set_value
    label: 'Load certificate available days'
    configuration:
      token_name: certificate-days
      token_value: '[item-list:field_days:value]'
      use_yaml: false
    successors:
      -
        id: Activity_1at16hs
        condition: Flow_13kh7pz
      -
        id: Activity_01cuhc5
        condition: Flow_1weflus
  Activity_0op8nbt:
    plugin: eca_set_field_value
    label: 'Set balance days'
    configuration:
      field_name: field_days
      field_value: '[balance-days]'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: false
      object: certificate-flow
    successors:
      -
        id: Activity_10e7qhi
        condition: ''
  Activity_1pjj4jr:
    plugin: eca_set_field_value
    label: 'Set operation with days'
    configuration:
      field_name: field_operation_with_days
      field_value: '[oper-days]'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: false
      object: certificate-flow
    successors:
      -
        id: Activity_0anwsyj
        condition: ''
  Activity_10e7qhi:
    plugin: 'eca_tamper:math'
    label: 'Calculating operation with days'
    configuration:
      operation: multiplication
      flip: false
      value: '-1'
      eca_data: '[full-days]'
      eca_token_name: oper-days
    successors:
      -
        id: Activity_1pjj4jr
        condition: ''
  Activity_1ne4p7y:
    plugin: eca_set_field_value
    label: 'Set operation "Using"'
    configuration:
      field_name: field_operation.target_id
      field_value: '2'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: true
      object: certificate-flow
    successors: {  }
  Activity_0oznekq:
    plugin: eca_new_entity
    label: 'Create new certificate flow'
    configuration:
      token_name: certificate-flow
      type: 'node certificate_flow'
      langcode: ''
      label: Using
      published: true
      owner: '1'
    successors:
      -
        id: Activity_0apdul0
        condition: ''
  Activity_0apdul0:
    plugin: eca_set_field_value
    label: 'Set certificate id'
    configuration:
      field_name: field_certificate
      field_value: '[certificate]'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: false
      object: certificate-flow
    successors:
      -
        id: Activity_0op8nbt
        condition: ''
  Activity_1nbpk7u:
    plugin: eca_token_load_entity
    label: 'Load certificate'
    configuration:
      token_name: certificate
      from: id
      entity_type: node
      entity_id: '[item-list:field_certificate:target_id]'
      revision_id: ''
      properties: ''
      langcode: _interface
      latest_revision: false
      unchanged: false
      object: ''
    successors:
      -
        id: Activity_13k94cl
        condition: Flow_10zgp9m
      -
        id: Activity_11etmyq
        condition: Flow_0ybozwb
  Activity_1upv4hy:
    plugin: eca_new_entity
    label: 'Create new certificate flow'
    configuration:
      token_name: certificate-flow
      type: 'node certificate_flow'
      langcode: ''
      label: Exhausted
      published: true
      owner: '1'
    successors:
      -
        id: Activity_0md9x5o
        condition: ''
  Activity_0md9x5o:
    plugin: eca_set_field_value
    label: 'Set certificate id'
    configuration:
      field_name: field_certificate
      field_value: '[certificate]'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: false
      object: certificate-flow
    successors:
      -
        id: Activity_051g6ky
        condition: ''
  Activity_01cuhc5:
    plugin: 'eca_tamper:math'
    label: 'Get remaining uncovered days'
    configuration:
      operation: subtraction
      flip: false
      value: '[certificate-days]'
      eca_data: '[full-days]'
      eca_token_name: full-days
    successors:
      -
        id: Activity_1upv4hy
        condition: ''
  Activity_051g6ky:
    plugin: 'eca_tamper:math'
    label: 'Calculating operation with days'
    configuration:
      operation: multiplication
      flip: false
      value: '-1'
      eca_data: '[certificate-days]'
      eca_token_name: oper-days
    successors:
      -
        id: Activity_1to36jl
        condition: ''
  Activity_1to36jl:
    plugin: eca_set_field_value
    label: 'Set field days to 0'
    configuration:
      field_name: field_days
      field_value: '0'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: false
      object: certificate-flow
    successors:
      -
        id: Activity_0fced9v
        condition: ''
  Activity_0fced9v:
    plugin: eca_set_field_value
    label: 'Set operation with days'
    configuration:
      field_name: field_operation_with_days
      field_value: '[oper-days]'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: false
      object: certificate-flow
    successors:
      -
        id: Activity_0kyi6q7
        condition: ''
  Activity_0kyi6q7:
    plugin: eca_set_field_value
    label: 'Set operation "Exhausted"'
    configuration:
      field_name: field_operation.target_id
      field_value: '5'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: false
      object: certificate-flow
    successors:
      -
        id: Activity_1aliwcg
        condition: ''
  Activity_1w7g9ev:
    plugin: eca_list_remove
    label: 'Pop first certificate flow info'
    configuration:
      value: ''
      token_name: item-list
      method: index
      index: '0'
      list_token: certificates-list
    successors:
      -
        id: Activity_1nbpk7u
        condition: Flow_1fiirzb
      -
        id: Activity_1w7g9ev
        condition: Flow_13bi7o1
  Activity_11etmyq:
    plugin: eca_token_set_value
    label: 'If certificate empty save id in token and avoid it'
    configuration:
      token_name: empty-certificate
      token_value: '[item-list:field_certificate:target_id]'
      use_yaml: false
    successors:
      -
        id: Activity_1w7g9ev
        condition: ''
  Activity_1ib0z07:
    plugin: eca_token_set_value
    label: 'Create token with empty certificate id to avoid it in next circle'
    configuration:
      token_name: empty-certificate
      token_value: '[item-list:field_certificate:target_id]'
      use_yaml: false
    successors:
      -
        id: Activity_1w7g9ev
        condition: ''
  Activity_0oyehfz:
    plugin: eca_token_load_entity_ref
    label: 'Load author'
    configuration:
      field_name_entity_ref: uid
      token_name: Author
      from: current
      entity_type: _none
      entity_id: ''
      revision_id: ''
      properties: ''
      langcode: _interface
      latest_revision: false
      unchanged: false
      object: ''
    successors:
      -
        id: Activity_0gg4cj4
        condition: ''
  Activity_0gg4cj4:
    plugin: eca_set_field_value
    label: 'Set title "Author''s vacation reques"'
    configuration:
      field_name: title
      field_value: "[author:name]'s vacation request"
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: false
      object: ''
    successors: {  }
  Activity_1abhdau:
    plugin: 'eca_tamper:strtotime'
    label: 'Start date to UNIX'
    configuration:
      eca_data: '[vacation:field_date:value]'
      eca_token_name: value
    successors:
      -
        id: Activity_1ow7ol1
        condition: ''
  Activity_1ow7ol1:
    plugin: 'eca_tamper:strtotime'
    label: 'End date to UNIX'
    configuration:
      eca_data: '[vacation:field_date:end_value]'
      eca_token_name: end_value
    successors:
      -
        id: Activity_0xf6sei
        condition: ''
  Activity_1hjb1ew:
    plugin: eca_form_field_set_error
    label: 'Show error in date'
    configuration:
      message: "You can't take more than 14 days off"
      field_name: field_date
    successors: {  }
  Activity_14it3nw:
    plugin: 'eca_tamper:strtotime'
    label: 'Start date time to UNIX'
    configuration:
      eca_data: '[vacation:field_date_and_time:value]'
      eca_token_name: value
    successors:
      -
        id: Activity_0uq60ov
        condition: Flow_0gn4cyn
      -
        id: Activity_068aabg
        condition: Flow_09doap1
  Activity_0uq60ov:
    plugin: 'eca_tamper:strtotime'
    label: 'End date time to UNIX'
    configuration:
      eca_data: '[vacation:field_date_and_time:end_value]'
      eca_token_name: end_value
    successors:
      -
        id: Activity_0pjqqiq
        condition: ''
  Activity_0pjqqiq:
    plugin: 'eca_tamper:math'
    label: Subtraction
    configuration:
      operation: subtraction
      flip: false
      value: '[value]'
      eca_data: '[end_value]'
      eca_token_name: full_days_unix
    successors:
      -
        id: Gateway_027c115
        condition: ''
  Activity_068aabg:
    plugin: eca_form_field_set_error
    label: 'Show error about past date input'
    configuration:
      message: 'Past times are not allowed'
      field_name: field_date_and_time
    successors: {  }
  Activity_0oh1zz6:
    plugin: eca_form_field_set_error
    label: 'Show error about past date input'
    configuration:
      message: 'Past times are not allowed'
      field_name: field_date
    successors: {  }
  Activity_06ty3x6:
    plugin: 'eca_tamper:timetodate'
    label: 'UNIX start date to day of week as number'
    configuration:
      date_format: w
      eca_data: '[value]'
      eca_token_name: start-day
    successors:
      -
        id: Activity_0yoggn0
        condition: Flow_0ulx093
  Activity_0yoggn0:
    plugin: eca_form_field_set_error
    label: 'Show error about weekend start day'
    configuration:
      message: 'You choosed a weekend as the start day for shorter than 7 days'
      field_name: field_date
    successors: {  }
  Activity_1venqzo:
    plugin: 'eca_tamper:timetodate'
    label: 'UNIX end date to day of week as number'
    configuration:
      date_format: w
      eca_data: '[end_value]'
      eca_token_name: end-date
    successors:
      -
        id: Activity_17adey6
        condition: Flow_17bbmvy
  Activity_17adey6:
    plugin: eca_form_field_set_error
    label: 'Show error about weekend start day'
    configuration:
      message: 'You choosed a weekend as the end day for shorter than 7 days'
      field_name: field_date
    successors: {  }
  Activity_141ema0:
    plugin: 'eca_tamper:timetodate'
    label: 'UNIX start date to day of week as number'
    configuration:
      date_format: w
      eca_data: '[value]'
      eca_token_name: start
    successors:
      -
        id: Activity_1wxy8b2
        condition: Flow_05b7gel
  Activity_1x09ig6:
    plugin: 'eca_tamper:timetodate'
    label: 'UNIX end date to day of week as number'
    configuration:
      date_format: w
      eca_data: '[end_value]'
      eca_token_name: end
    successors:
      -
        id: Activity_0ffiv3f
        condition: Flow_065tefo
  Activity_1wxy8b2:
    plugin: eca_form_field_set_error
    label: 'Show error about weekend start day'
    configuration:
      message: 'You choosed a weekend as the start day for shorter than 7 days'
      field_name: field_date_and_time
    successors: {  }
  Activity_0ffiv3f:
    plugin: eca_form_field_set_error
    label: 'Show error about weekend start day'
    configuration:
      message: 'You choosed a weekend as the start day for shorter than 7 days'
      field_name: field_date_and_time
    successors: {  }
  Activity_04i0v17:
    plugin: eca_token_load_entity_ref
    label: 'Load author'
    configuration:
      field_name_entity_ref: uid
      token_name: author
      from: current
      entity_type: _none
      entity_id: ''
      revision_id: ''
      properties: ''
      langcode: _interface
      latest_revision: false
      unchanged: false
      object: ''
    successors:
      -
        id: Activity_1g9crnp
        condition: ''
      -
        id: Activity_1bfi7vm
        condition: ''
  Activity_08s8ucx:
    plugin: eca_form_field_set_error
    label: 'Show error not enough available days'
    configuration:
      message: "You don't have anough available days for paid vacation. You have: [available-days], you need: [full_days]"
      field_name: field_date
    successors: {  }
  Activity_1pqdgok:
    plugin: eca_token_load_entity
    label: 'Load vacation'
    configuration:
      token_name: vacation
      from: current
      entity_type: _none
      entity_id: ''
      revision_id: ''
      properties: ''
      langcode: _interface
      latest_revision: false
      unchanged: false
      object: ''
    successors:
      -
        id: Activity_0210lgf
        condition: ''
  Activity_0wqdocf:
    plugin: 'eca_tamper:timetodate'
    label: 'UNIX end date to day of week as number'
    configuration:
      date_format: w
      eca_data: '[end_value]'
      eca_token_name: end-date
    successors:
      -
        id: Activity_04i0v17
        condition: Flow_06z3po8
  Activity_05ki6s5:
    plugin: eca_token_set_value
    label: 'Token current day'
    configuration:
      token_name: current-day
      token_value: '[current-date:date_all_day]'
      use_yaml: false
    successors:
      -
        id: Activity_07jnsz3
        condition: ''
  Activity_07jnsz3:
    plugin: 'eca_tamper:strtotime'
    label: 'Current day to UNIX'
    configuration:
      eca_data: '[current-day]'
      eca_token_name: current-day-unix
    successors:
      -
        id: Activity_0ha6m6d
        condition: ''
  Activity_0ha6m6d:
    plugin: 'eca_tamper:math'
    label: 'Subtract start date from current'
    configuration:
      operation: subtraction
      flip: false
      value: '[current-day-unix]'
      eca_data: '[value]'
      eca_token_name: result
    successors:
      -
        id: Activity_0oh1zz6
        condition: Flow_1xys2u5
  Activity_0gt4sye:
    plugin: eca_form_field_set_error
    label: "Show error paid vacation can't start today"
    configuration:
      message: "Paid vacation can't start today, change date or request unpaid vacation"
      field_name: field_date
    successors: {  }
  Activity_1205289:
    plugin: eca_token_set_value
    label: 'Token current day'
    configuration:
      token_name: current-day
      token_value: '[current-date:date_all_day]'
      use_yaml: false
    successors:
      -
        id: Activity_15e9d2i
        condition: ''
  Activity_15e9d2i:
    plugin: 'eca_tamper:strtotime'
    label: 'Current day to UNIX'
    configuration:
      eca_data: '[current-day]'
      eca_token_name: current-day-unix
    successors:
      -
        id: Activity_1qa5du5
        condition: ''
  Activity_1qa5du5:
    plugin: 'eca_tamper:math'
    label: 'Subtract start date from current'
    configuration:
      operation: subtraction
      flip: false
      value: '[current-day-unix]'
      eca_data: '[value]'
      eca_token_name: result
    successors:
      -
        id: Gateway_1i45bsy
        condition: Flow_1ip05hy
  Activity_1e0bln0:
    plugin: 'eca_tamper:timetodate'
    label: 'UNIX start date to day of week as number'
    configuration:
      date_format: w
      eca_data: '[value]'
      eca_token_name: start-date
    successors:
      -
        id: Activity_1xg1csj
        condition: Flow_0p68wki
      -
        id: Activity_0wqdocf
        condition: Flow_0u3qx2u
  Activity_0l060nh:
    plugin: 'eca_tamper:timetodate'
    label: 'UNIX end date to day of week as number'
    configuration:
      date_format: w
      eca_data: '[end_value]'
      eca_token_name: end-date
    successors:
      -
        id: Activity_13tsq27
        condition: Flow_1kzm27b
  Activity_13tsq27:
    plugin: eca_form_field_set_error
    label: 'Show error about weekend start day'
    configuration:
      message: 'You choosed a weekend as the end day for shorter than 7 days'
      field_name: field_date
    successors: {  }
  Activity_1xg1csj:
    plugin: eca_form_field_set_error
    label: 'Show error about weekend start day'
    configuration:
      message: 'You choosed a weekend as the start day for shorter than 7 days'
      field_name: field_date
    successors: {  }
  Activity_1vmlac8:
    plugin: 'eca_tamper:timetodate'
    label: 'UNIX start date to hours'
    configuration:
      date_format: H
      eca_data: '[value-time]'
      eca_token_name: start-time
    successors:
      -
        id: Activity_17woknc
        condition: Flow_1yij4ae
  Activity_12kqf6o:
    plugin: eca_form_field_set_error
    label: 'Show error non-working end time'
    configuration:
      message: 'The selected end time is not within working schedule'
      field_name: field_date_and_time
    successors: {  }
  Activity_1u7iiy9:
    plugin: 'eca_tamper:timetodate'
    label: 'UNIX end date to hours'
    configuration:
      date_format: H
      eca_data: '[end_value-time]'
      eca_token_name: end-time
    successors:
      -
        id: Activity_12kqf6o
        condition: Flow_1wmchkk
      -
        id: Activity_0y3jpta
        condition: Flow_1ft2sqb
  Activity_0y3jpta:
    plugin: 'eca_tamper:timetodate'
    label: 'UNIX end date to minutes'
    configuration:
      date_format: I
      eca_data: '[end_value-time]'
      eca_token_name: end-minutes
    successors:
      -
        id: Activity_12kqf6o
        condition: Flow_0e1244m
  Activity_143ljic:
    plugin: eca_form_field_set_error
    label: 'Show error about past date input'
    configuration:
      message: 'Past times are not allowed'
      field_name: field_date
    successors: {  }
  Activity_17woknc:
    plugin: eca_form_field_set_error
    label: 'Show error non-working start time'
    configuration:
      message: 'The selected start time is not within working schedule'
      field_name: field_date_and_time
    successors: {  }
  Activity_1cz4133:
    plugin: eca_form_build_entity
    label: 'Build vacation'
    configuration:
      token_name: vacation
    successors:
      -
        id: Activity_14it3nw
        condition: Flow_19jcp7c
      -
        id: Activity_1abhdau
        condition: Flow_01v7pmu
      -
        id: Activity_14urdx6
        condition: ''
  Activity_1g9crnp:
    plugin: eca_views_query
    label: 'Execute query for user balance'
    configuration:
      token_name: record
      view_id: records
      display_id: default
      arguments: '[author]'
    successors:
      -
        id: Activity_03x4rhu
        condition: ''
  Activity_03x4rhu:
    plugin: eca_token_set_value
    label: 'Get balance'
    configuration:
      token_name: available-days
      token_value: '[record:0:field_balance]'
      use_yaml: false
    successors:
      -
        id: Activity_08s8ucx
        condition: Flow_093mlke
      -
        id: Activity_0zrgikr
        condition: Flow_1o3t2ck
  Activity_1cnbpyz:
    plugin: 'eca_tamper:math'
    label: Subtraction
    configuration:
      operation: subtraction
      flip: false
      value: '[value]'
      eca_data: '[end_value]'
      eca_token_name: full_days_unix
    successors:
      -
        id: Activity_1vqj1g6
        condition: ''
  Activity_0ew26i2:
    plugin: 'eca_tamper:math'
    label: '+1 day'
    configuration:
      operation: addition
      flip: false
      value: '1'
      eca_data: '[full_days_without_1]'
      eca_token_name: full_days
    successors:
      -
        id: Gateway_15mw1e4
        condition: Flow_02i7rv5
      -
        id: Gateway_1vxt6p4
        condition: Flow_1n38jv4
  Activity_1ajgw72:
    plugin: 'eca_tamper:strtotime'
    label: 'Start date to UNIX'
    configuration:
      eca_data: '[node:field_date:value]'
      eca_token_name: value
    successors:
      -
        id: Activity_0c5unsl
        condition: ''
  Activity_0c5unsl:
    plugin: 'eca_tamper:strtotime'
    label: 'End date to UNIX'
    configuration:
      eca_data: '[node:field_date:end_value]'
      eca_token_name: end_value
    successors:
      -
        id: Activity_1cnbpyz
        condition: ''
  Activity_1vqj1g6:
    plugin: 'eca_tamper:math'
    label: 'UNIX to days'
    configuration:
      operation: division
      flip: false
      value: '86400'
      eca_data: '[full_days_unix]'
      eca_token_name: full_days_without_1
    successors:
      -
        id: Activity_1wh2kg4
        condition: ''
  Activity_0zrgikr:
    plugin: 'eca_tamper:math'
    label: 'Future balance'
    configuration:
      operation: subtraction
      flip: false
      value: '[full_days]'
      eca_data: '[record:0:field_balance]'
      eca_token_name: future-balance
    successors:
      -
        id: Activity_178mhls
        condition: Flow_1xth8tc
  Activity_031jk35:
    plugin: eca_get_field_value
    label: 'Get user creation date'
    configuration:
      field_name: created
      token_name: user-created
      object: author
    successors:
      -
        id: Activity_0zhpkwt
        condition: ''
  Activity_0zhpkwt:
    plugin: 'eca_tamper:math'
    label: 'Get seniority in seconds'
    configuration:
      operation: subtraction
      flip: false
      value: '[user-created]'
      eca_data: '[current-date:raw]'
      eca_token_name: seniority
    successors:
      -
        id: Gateway_19ezeba
        condition: Flow_0k5oqxr
  Activity_178mhls:
    plugin: eca_views_query
    label: 'Execute query with long vacations of that user'
    configuration:
      token_name: relax
      view_id: long_vacation
      display_id: default
      arguments: '[author]'
    successors:
      -
        id: Activity_031jk35
        condition: ''
  Activity_17ck8vl:
    plugin: eca_form_field_set_error
    label: 'Show error need longer rest or unpaid'
    configuration:
      message: 'Take at least 7 days off or leave 7 days for a good break (Unpaid vacation is also an option!)'
      field_name: field_date
    successors: {  }
  Activity_0n9zlw6:
    plugin: 'eca_tamper:math'
    label: 'Seniority to years'
    configuration:
      operation: division
      flip: false
      value: '720'
      eca_data: '[seniority]'
      eca_token_name: seniority-full-years
    successors:
      -
        id: Activity_0opkvim
        condition: ''
  Activity_0x0svtf:
    plugin: 'eca_tamper:math'
    label: 'Back to seconds'
    configuration:
      operation: multiplication
      flip: false
      value: '720'
      eca_data: '[seniority-full-years]'
      eca_token_name: seniority-years
    successors:
      -
        id: Activity_0r6oz8n
        condition: ''
  Activity_0k187ib:
    plugin: eca_form_field_set_error
    label: 'Show error need longer rest or unpaid'
    configuration:
      message: 'Take at least 7 days off or leave 7 days for a good break (Unpaid vacation is also an option!)'
      field_name: field_date
    successors: {  }
  Activity_0opkvim:
    plugin: 'eca_tamper:cast_to_int'
    label: 'Cast to integer to get only full years'
    configuration:
      eca_data: '[seniority-full-years]'
      eca_token_name: seniority-full-years
    successors:
      -
        id: Activity_0x0svtf
        condition: ''
  Activity_0r6oz8n:
    plugin: 'eca_tamper:math'
    label: 'Get only months in seconds'
    configuration:
      operation: subtraction
      flip: false
      value: '[seniority-years]'
      eca_data: '[seniority]'
      eca_token_name: seniority-months
    successors:
      -
        id: Activity_0bqopqz
        condition: ''
  Activity_0bqopqz:
    plugin: 'eca_tamper:math'
    label: 'Months in seconds to months'
    configuration:
      operation: division
      flip: false
      value: '60'
      eca_data: '[seniority-months]'
      eca_token_name: seniority-months
    successors:
      -
        id: Activity_0k187ib
        condition: Flow_0l1fko4
  Activity_1s8anfc:
    plugin: eca_get_field_value
    label: 'Get entity id'
    configuration:
      field_name: entity_id
      token_name: entity-id
      object: ''
    successors:
      -
        id: Activity_1d9db9z
        condition: ''
  Activity_1d9db9z:
    plugin: eca_token_load_entity
    label: 'Load vacation'
    configuration:
      token_name: vacation
      from: id
      entity_type: node
      entity_id: '[entity-id]'
      revision_id: ''
      properties: ''
      langcode: _interface
      latest_revision: false
      unchanged: false
      object: ''
    successors:
      -
        id: Activity_1s8uj95
        condition: Flow_1uybf16
  Activity_1s8uj95:
    plugin: eca_get_field_value
    label: 'Get full-days from vacation'
    configuration:
      field_name: field_full_days
      token_name: full-days
      object: vacation
    successors:
      -
        id: Activity_108imqo
        condition: Flow_18epwfg
      -
        id: Activity_1lbyqth
        condition: Flow_0vtx2bx
  Activity_108imqo:
    plugin: eca_views_query
    label: 'Execute query for getting all certificates that took part in vacation'
    configuration:
      token_name: records-list
      view_id: vacation_s_certificates
      display_id: default
      arguments: '[entity-id]'
    successors:
      -
        id: Activity_13lmvuy
        condition: ''
  Activity_13lmvuy:
    plugin: eca_list_remove
    label: 'Pop record'
    configuration:
      value: ''
      token_name: record
      method: first
      index: ''
      list_token: records-list
    successors:
      -
        id: Activity_0u5jd1j
        condition: ''
  Activity_0u5jd1j:
    plugin: eca_token_load_entity_ref
    label: 'Load certificate'
    configuration:
      field_name_entity_ref: field_certificate
      token_name: certificate
      from: current
      entity_type: _none
      entity_id: ''
      revision_id: ''
      properties: ''
      langcode: _interface
      latest_revision: false
      unchanged: false
      object: record
    successors:
      -
        id: Activity_1gkkzvc
        condition: ''
  Activity_0kdw9mq:
    plugin: eca_set_field_value
    label: 'Set vacation'
    configuration:
      field_name: field_vacation.target_id
      field_value: '[vacation]'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: false
      object: certificate-flow
    successors:
      -
        id: Activity_1ne4p7y
        condition: Flow_16d6wjp
      -
        id: Activity_1alsuz4
        condition: Flow_0s9jvoi
  Activity_0jiwdqf:
    plugin: eca_set_field_value
    label: 'Set vacation'
    configuration:
      field_name: field_vacation.target_id
      field_value: '[vacation]'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: true
      object: certificate-flow
    successors:
      -
        id: Activity_1ib0z07
        condition: ''
  Activity_1gkkzvc:
    plugin: eca_views_query
    label: 'Get last record'
    configuration:
      token_name: last-record
      view_id: records_by_certificate
      display_id: default
      arguments: '[certificate]'
    successors:
      -
        id: Activity_0klsiq4
        condition: ''
  Activity_1lbyqth:
    plugin: eca_set_field_value
    label: 'Set cancel'
    configuration:
      field_name: field_status
      field_value: '8'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: true
      object: vacation
    successors: {  }
  Activity_1alsuz4:
    plugin: eca_set_field_value
    label: 'Set operation "Exhausted"'
    configuration:
      field_name: field_operation.target_id
      field_value: '5'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: true
      object: certificate-flow
    successors: {  }
  Activity_1warw26:
    plugin: eca_form_field_set_error
    label: 'Error current user approver'
    configuration:
      message: "You can't be approver for own vacation"
      field_name: field_approvers
    successors: {  }
  Activity_0klsiq4:
    plugin: eca_new_entity
    label: 'Create certificate returning record'
    configuration:
      token_name: certificate-flow
      type: 'node certificate_flow'
      langcode: ''
      label: Returning
      published: true
      owner: '1'
    successors:
      -
        id: Activity_0cgzmz4
        condition: ''
  Activity_0cgzmz4:
    plugin: eca_set_field_value
    label: 'Set certificate id'
    configuration:
      field_name: field_certificate
      field_value: '[certificate]'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: false
      object: certificate-flow
    successors:
      -
        id: Activity_1g698pb
        condition: ''
  Activity_016nmcj:
    plugin: eca_set_field_value
    label: 'Set balance days'
    configuration:
      field_name: field_days
      field_value: '[balance-days]'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: false
      object: certificate-flow
    successors:
      -
        id: Activity_09wu5x2
        condition: ''
  Activity_1jinqsu:
    plugin: eca_set_field_value
    label: 'Set operation with days'
    configuration:
      field_name: field_operation_with_days
      field_value: '[oper-days]'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: false
      object: certificate-flow
    successors:
      -
        id: Activity_1j31wmo
        condition: ''
  Activity_09wu5x2:
    plugin: eca_set_field_value
    label: 'Set vacation'
    configuration:
      field_name: field_vacation.target_id
      field_value: '[vacation]'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: false
      object: certificate-flow
    successors:
      -
        id: Activity_13r4y25
        condition: Flow_09h8t4r
  Activity_13r4y25:
    plugin: eca_set_field_value
    label: 'Set operation "Returning"'
    configuration:
      field_name: field_operation.target_id
      field_value: '4'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: false
      object: certificate-flow
    successors:
      -
        id: Activity_04ljlgc
        condition: ''
  Activity_1g698pb:
    plugin: 'eca_tamper:math'
    label: 'Calculating operation with days'
    configuration:
      operation: multiplication
      flip: false
      value: '-1'
      eca_data: '[record:field_operation_with_days:value]'
      eca_token_name: oper-days
    successors:
      -
        id: Activity_1jinqsu
        condition: ''
  Activity_1j31wmo:
    plugin: 'eca_tamper:math'
    label: 'Calculate balance'
    configuration:
      operation: addition
      flip: false
      value: '[last-record:0:field_days]'
      eca_data: '[oper-days]'
      eca_token_name: balance-days
    successors:
      -
        id: Activity_016nmcj
        condition: ''
  Activity_14urdx6:
    plugin: eca_token_load_entity_ref
    label: 'Load current user'
    configuration:
      field_name_entity_ref: uid
      token_name: author-name
      from: current
      entity_type: _none
      entity_id: ''
      revision_id: ''
      properties: ''
      langcode: _interface
      latest_revision: false
      unchanged: false
      object: vacation
    successors:
      -
        id: Activity_1warw26
        condition: Flow_0d6m569
  Activity_04ljlgc:
    plugin: eca_token_load_entity_ref
    label: 'Load user'
    configuration:
      field_name_entity_ref: field_user
      token_name: certificate-user
      from: current
      entity_type: _none
      entity_id: ''
      revision_id: ''
      properties: ''
      langcode: _interface
      latest_revision: false
      unchanged: false
      object: certificate
    successors:
      -
        id: Activity_0l6mya5
        condition: ''
  Activity_0l6mya5:
    plugin: eca_views_query
    label: "Get previous record about user's certificates"
    configuration:
      token_name: previous-record
      view_id: records
      display_id: block_2
      arguments: '[certificate-user]'
    successors:
      -
        id: Activity_15oa7ke
        condition: ''
  Activity_15oa7ke:
    plugin: 'eca_tamper:cast_to_int'
    label: 'Get available days from query'
    configuration:
      eca_data: '[previous-record:0:field_balance]'
      eca_token_name: available
    successors:
      -
        id: Activity_0qnhysf
        condition: ''
  Activity_0qnhysf:
    plugin: 'eca_tamper:math'
    label: 'Calculate current available days'
    configuration:
      operation: addition
      flip: false
      value: '[oper-days]'
      eca_data: '[available]'
      eca_token_name: current-available-days
    successors:
      -
        id: Activity_1eckg25
        condition: ''
  Activity_1eckg25:
    plugin: eca_set_field_value
    label: 'Set available days'
    configuration:
      field_name: field_balance
      field_value: '[current-available-days]'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: true
      object: certificate-flow
    successors:
      -
        id: Activity_13lmvuy
        condition: ''
  Activity_0anwsyj:
    plugin: eca_token_load_entity_ref
    label: 'Load user'
    configuration:
      field_name_entity_ref: field_user
      token_name: certificate-user
      from: current
      entity_type: _none
      entity_id: ''
      revision_id: ''
      properties: ''
      langcode: _interface
      latest_revision: false
      unchanged: false
      object: certificate
    successors:
      -
        id: Activity_0ix1clk
        condition: ''
  Activity_0ix1clk:
    plugin: eca_views_query
    label: "Get previous record about user's certificates"
    configuration:
      token_name: previous-record
      view_id: records
      display_id: block_2
      arguments: '[certificate-user]'
    successors:
      -
        id: Activity_09939x1
        condition: ''
  Activity_09939x1:
    plugin: 'eca_tamper:cast_to_int'
    label: 'Get available days from query'
    configuration:
      eca_data: '[previous-record:0:field_balance]'
      eca_token_name: available
    successors:
      -
        id: Activity_1iwa98s
        condition: ''
  Activity_1iwa98s:
    plugin: 'eca_tamper:math'
    label: 'Calculate current available days'
    configuration:
      operation: addition
      flip: false
      value: '[oper-days]'
      eca_data: '[available]'
      eca_token_name: current-available-days
    successors:
      -
        id: Activity_0v7q84d
        condition: ''
  Activity_0v7q84d:
    plugin: eca_set_field_value
    label: 'Set available days'
    configuration:
      field_name: field_balance
      field_value: '[current-available-days]'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: true
      object: certificate-flow
    successors:
      -
        id: Activity_0kdw9mq
        condition: ''
  Activity_03it5di:
    plugin: eca_set_field_value
    label: 'Set available days'
    configuration:
      field_name: field_balance
      field_value: '[current-available-days]'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: true
      object: certificate-flow
    successors:
      -
        id: Activity_0jiwdqf
        condition: ''
  Activity_1aliwcg:
    plugin: eca_token_load_entity_ref
    label: 'Load user'
    configuration:
      field_name_entity_ref: field_user
      token_name: certificate-user
      from: current
      entity_type: _none
      entity_id: ''
      revision_id: ''
      properties: ''
      langcode: _interface
      latest_revision: false
      unchanged: false
      object: certificate
    successors:
      -
        id: Activity_1h7mx6a
        condition: ''
  Activity_1h7mx6a:
    plugin: eca_views_query
    label: "Get previous record about user's certificates"
    configuration:
      token_name: previous-record
      view_id: records
      display_id: block_2
      arguments: '[certificate-user]'
    successors:
      -
        id: Activity_1ur06qe
        condition: ''
  Activity_1ur06qe:
    plugin: 'eca_tamper:cast_to_int'
    label: 'Get available days from query'
    configuration:
      eca_data: '[previous-record:0:field_balance]'
      eca_token_name: available
    successors:
      -
        id: Activity_1fffsra
        condition: ''
  Activity_1fffsra:
    plugin: 'eca_tamper:math'
    label: 'Calculate current available days'
    configuration:
      operation: addition
      flip: false
      value: '[oper-days]'
      eca_data: '[available]'
      eca_token_name: current-available-days
    successors:
      -
        id: Activity_03it5di
        condition: ''
  Activity_1bfi7vm:
    plugin: eca_views_query
    label: 'Execute query to get all paid vacations'
    configuration:
      token_name: paid-vacations
      view_id: paid_vacations
      display_id: default
      arguments: '[author]'
    successors:
      -
        id: Activity_1lthfxj
        condition: ''
  Activity_1lthfxj:
    plugin: eca_list_remove
    label: 'Get first paid vacation'
    configuration:
      value: ''
      token_name: paid-vacation
      method: first
      index: ''
      list_token: paid-vacations
    successors:
      -
        id: Activity_1wcw7hb
        condition: ''
  Activity_1wcw7hb:
    plugin: 'eca_tamper:strtotime'
    label: 'Get start day from previous vacation'
    configuration:
      eca_data: '[paid-vacation:field_date:value]'
      eca_token_name: start-day2
    successors:
      -
        id: Activity_0sivnz2
        condition: ''
  Activity_0xdb4mq:
    plugin: 'eca_tamper:math'
    label: 'Calculate difference between starting dates'
    configuration:
      operation: subtraction
      flip: false
      value: '[value]'
      eca_data: '[start-day2]'
      eca_token_name: start-difference
    successors:
      -
        id: Activity_0kizd43
        condition: ''
  Activity_0kizd43:
    plugin: 'eca_tamper:math'
    label: 'Difference to days'
    configuration:
      operation: division
      flip: false
      value: '86400'
      eca_data: '[start-difference]'
      eca_token_name: start-difference-day
    successors:
      -
        id: Activity_1lthfxj
        condition: Flow_03uh7pd
      -
        id: Gateway_12mm88y
        condition: Flow_1bnvccu
      -
        id: Activity_11w4pi5
        condition: Flow_1jbwjo2
      -
        id: Gateway_1nby4so
        condition: Flow_0k39bz5
  Activity_11w4pi5:
    plugin: eca_form_field_set_error
    label: 'Show error about already taken vacation for choosen dates'
    configuration:
      message: 'You already have paid vacation for some of chosen days'
      field_name: field_date
    successors: {  }
  Activity_0sivnz2:
    plugin: 'eca_tamper:strtotime'
    label: 'Get end day from previous vacation'
    configuration:
      eca_data: '[paid-vacation:field_date:end_value]'
      eca_token_name: end-day2
    successors:
      -
        id: Activity_0xdb4mq
        condition: ''
